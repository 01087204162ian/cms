<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>여행자보험 정보 입력</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <style>
        body { font-family: 'Pretendard', sans-serif; touch-action: manipulation; }
        input, select, textarea { font-size: 16px !important; }
        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        /* 탭 전환 애니메이션 */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-10">

    <header class="bg-white border-b border-gray-100 sticky top-0 z-10 shadow-sm">
        <div class="max-w-md mx-auto px-5 py-4 flex items-center justify-center relative">
            <h1 class="text-lg font-bold text-gray-800">여행자보험 정보 입력</h1>
        </div>
        
        <div class="max-w-md mx-auto grid grid-cols-2 text-center text-sm font-bold bg-white">
            <button onclick="switchTab('apply')" id="tab-apply" class="py-3 border-b-2 border-blue-600 text-blue-600 transition">
                신규 신청
            </button>
            <button onclick="switchTab('check')" id="tab-check" class="py-3 border-b-2 border-transparent text-gray-400 hover:text-gray-600 transition">
                조회 / 수정 / 취소
            </button>
        </div>
    </header>

    <main class="max-w-md mx-auto px-4 pt-6">
        
        <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100 mb-6">
            <h2 class="text-xl font-bold text-gray-900 mb-2">OO대학교 학생회 하계 워크숍</h2>
            <p class="text-sm text-gray-500">2025.07.15 ~ 2025.07.17 (제주도)</p>
        </div>

        <div id="view-apply" class="tab-content active">
            <form onsubmit="handleJoinSubmit(event)">
                <section class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-5">참가자 정보</h3>
                    <div class="space-y-5">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">이름</label>
                            <input type="text" required placeholder="실명 입력" class="input-field w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">주민등록번호</label>
                            <input type="tel" required maxlength="14" placeholder="YYMMDD-XXXXXXX" class="rrn-input w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-blue-500 focus:outline-none transition tracking-wider" oninput="formatRRN(this)">
                        </div>
                    </div>
                </section>

                <section class="mb-24">
                    <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 space-y-4">
                        <label class="flex items-center"><input type="checkbox" required class="w-5 h-5 mr-3 text-blue-600 rounded"><span class="text-sm font-bold">(필수) 개인정보 수집·이용 동의</span></label>
                        <hr class="border-gray-100">
                        <label class="flex items-center"><input type="checkbox" required class="w-5 h-5 mr-3 text-blue-600 rounded"><span class="text-sm font-bold">(필수) 고유식별정보 처리 동의</span></label>
                    </div>
                </section>

                <div class="fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 safe-area-bottom z-20">
                    <div class="max-w-md mx-auto">
                        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg">동의하고 입력 완료</button>
                    </div>
                </div>
            </form>
        </div>

        <div id="view-check" class="tab-content">
            
            <div id="check-step-1">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">내 신청 내역 조회</h3>
                    <p class="text-sm text-gray-500 mb-6">신청 시 입력했던 정보를 입력해주세요.</p>
                    
                    <div class="space-y-4">
                        <input type="text" id="check-name" placeholder="이름" class="w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl">
                        <input type="tel" id="check-rrn" maxlength="14" placeholder="주민등록번호" class="w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl tracking-wider" oninput="formatRRN(this)">
                    </div>

                    <button onclick="handleLookup()" class="w-full mt-6 bg-slate-800 text-white font-bold py-3.5 rounded-xl">조회하기</button>
                </div>
            </div>

            <div id="check-step-2" class="hidden">
                <div class="bg-green-50 border border-green-200 rounded-2xl p-5 mb-6 text-center">
                    <p class="text-green-800 font-bold text-lg mb-1">신청 내역이 있습니다.</p>
                    <p class="text-green-600 text-sm">입력일: 2025.12.02</p>
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <button onclick="alert('입력했던 정보를 불러옵니다.\n수정 후 다시 [입력 완료] 버튼을 누르시면 됩니다.'); switchTab('apply');" 
                        class="bg-blue-100 text-blue-700 font-bold py-4 rounded-xl hover:bg-blue-200 transition">
                        정보 수정하기
                    </button>
                    
                    <button onclick="handleCancel()" 
                        class="bg-red-50 text-red-600 border border-red-100 font-bold py-4 rounded-xl hover:bg-red-100 transition">
                        신청 취소(삭제)
                    </button>
                </div>
            </div>
        </div>

    </main>

    <script>
        // 탭 전환 함수
        function switchTab(tabName) {
            // 버튼 스타일 초기화
            document.getElementById('tab-apply').className = "py-3 border-b-2 border-transparent text-gray-400 hover:text-gray-600 transition";
            document.getElementById('tab-check').className = "py-3 border-b-2 border-transparent text-gray-400 hover:text-gray-600 transition";
            
            // 컨텐츠 숨김
            document.getElementById('view-apply').classList.remove('active');
            document.getElementById('view-check').classList.remove('active');

            // 선택된 탭 활성화
            if(tabName === 'apply') {
                document.getElementById('tab-apply').className = "py-3 border-b-2 border-blue-600 text-blue-600 transition";
                document.getElementById('view-apply').classList.add('active');
            } else {
                document.getElementById('tab-check').className = "py-3 border-b-2 border-slate-600 text-slate-800 transition";
                document.getElementById('view-check').classList.add('active');
            }
        }

        // 주민번호 포맷팅 (공통)
        function formatRRN(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            if (value.length > 6) {
                input.value = value.substring(0, 6) + '-' + value.substring(6, 13);
            } else {
                input.value = value;
            }
        }

        // 주민번호 검증 로직 (Checksum)
        function isValidRRN(rrn) {
            const num = rrn.replace(/[^0-9]/g, '');
            if (num.length !== 13) return false;
            const arr = num.split('').map(Number);
            const weights = [2, 3, 4, 5, 6, 7, 8, 9, 2, 3, 4, 5];
            let sum = 0;
            for (let i = 0; i < 12; i++) sum += arr[i] * weights[i];
            const result = (11 - (sum % 11)) % 10;
            return result === arr[12];
        }

        // 조회 시뮬레이션
        function handleLookup() {
            const name = document.getElementById('check-name').value;
            const rrn = document.getElementById('check-rrn').value;

            if(!name || rrn.length < 14) {
                alert('이름과 주민등록번호를 정확히 입력해주세요.');
                return;
            }

            // 시뮬레이션: 무조건 찾는 척 함 (실제론 DB 조회 필요)
            // 로딩 효과
            const btn = event.target;
            const originalText = btn.innerText;
            btn.innerText = "조회 중...";
            
            setTimeout(() => {
                btn.innerText = originalText;
                document.getElementById('check-step-1').style.display = 'none';
                document.getElementById('check-step-2').classList.remove('hidden');
                document.getElementById('check-step-2').classList.add('animate-fade-in-up');
            }, 800);
        }

        // 취소 처리
        function handleCancel() {
            if(confirm('정말 신청을 취소하시겠습니까?\n입력하신 정보는 즉시 삭제됩니다.')) {
                alert('취소(삭제)가 완료되었습니다.');
                window.location.reload();
            }
        }

        // 신청 제출 (검증 포함)
        function handleJoinSubmit(e) {
            e.preventDefault();
            // 주민번호 필드 찾기 (Form 내부)
            const rrnInput = e.target.querySelector('.rrn-input');
            
            if (!isValidRRN(rrnInput.value)) {
                alert('잘못된 주민등록번호입니다. 다시 확인해주세요.');
                rrnInput.focus();
                rrnInput.classList.add('shake', 'border-red-500', 'ring-2', 'ring-red-100');
                setTimeout(() => rrnInput.classList.remove('shake'), 500);
                return;
            }
            
            alert('입력이 완료되었습니다!');
            // 실제 서버 전송 로직 위치
        }
    </script>
</body>
</html>