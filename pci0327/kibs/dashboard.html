<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>대리운전 보험 CMS - 대시보드</title>
  <!-- Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="./css/basic.css">
  <link rel="stylesheet" href="./css/modal.css">
  <link rel="stylesheet" href="./css/driver.css">

</head>
<body>
  <!-- 세션 타임아웃 표시 -->
  <div id="sessionTimerDisplay" class="session-timer">
    <i class="fas fa-clock me-1"></i> <span id="sessionTimeRemaining">30:00</span> 후 자동 로그아웃
  </div>
  
  <!-- 사이드바 -->
  <div class="sidebar" id="sidebar">
    <div class="logo">
      <h4><small id="userCompany">회사정보</small></h4>
    </div>
    <div class="user-panel p-3 mb-3">
      <div class="text-white mb-2">
        <span class="fw-bold" id="userName"></span> 님 반갑습니다.
      </div>
      <div class="user-info">
        <div class="text-white">
          <div>배서기준일: <span id="endorsementDate">0000-00-00</span></div>
        </div>
      </div>
    </div>
    <hr class="mx-3 my-2 bg-light opacity-25">
    <ul class="nav flex-column">
      <!-- 홈 -->
      <li class="nav-item">
        <a href="#home" class="nav-link active" data-bs-toggle="tab">
          <i class="fas fa-home"></i> 증권정보
        </a>
      </li>
      <!-- 기사찾기 -->
      <li class="nav-item">
        <a href="#driver-search" class="nav-link" data-bs-toggle="tab">
          <i class="fas fa-search"></i> 기사찾기
        </a>
      </li>
      <!-- 문자리스트 -->
      <li class="nav-item">
        <a href="#sms-list" class="nav-link" data-bs-toggle="tab">
          <i class="fas fa-comment"></i> 문자리스트
        </a>
      </li>
      <!-- 로그아웃 -->
      <li class="nav-item mt-4">
        <a href="#" class="nav-link" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> 로그아웃
        </a>
      </li>
    </ul>
  </div>

  <!-- 메인 콘텐츠 -->
  <div class="content">
    <div class="top-bar">
      <button class="mobile-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </button>
      <div class="page-title">
        <h5 class="m-0" id="currentPageTitle">증권정보</h5>
      </div>
    </div>

    <div class="tab-content">
      <!-- 홈 탭 -->
      <div class="tab-pane fade show active" id="home">
       
        
        <!-- 동적 카드가 추가될 컨테이너 -->
        <div class="row" id="dynamicCardContainer">
          <!-- 로딩 상태 개선 -->
          <div class="col-12 text-center py-5" id="loading-state">
            <div class="loading-content">
              <div class="loading-spinner mb-3"></div>
              <div class="text-muted">증권 정보를 불러오는 중...</div>
            </div>
          </div>
        </div>

        <!-- 진행 중인 배서 및 진행 완료 배서 섹션 -->
        <div class="row">
          <!-- 모바일에서 숨김 처리 추가 -->
          <div class="col-lg-6 mb-4 d-none d-md-block">
            <div class="dashboard-card">
              <h5 class="mb-3 d-flex justify-content-between align-items-center">
                진행 중인 배서
                <span class="badge bg-primary" id="ongoing-count">0건</span>
              </h5>
              <div class="table-responsive table-fixed-header">
                <table class="table table-hover table-mobile-stack">
                  <thead>
                    <tr>
                      <th>번호</th>
                      <th>성명</th>
                      <th>주민번호</th>
                      <th>핸드폰</th>
                      <th>보험사</th>
                      <th>증권번호</th>
                      <th>증권성격</th>
                      <th>상태</th>
                    </tr>
                  </thead>
                  <tbody id='enderose_list_01'>
                    <!-- home_data_endorse.php return data 동적으로 표시 -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>


          <!-- 모바일 카드 뷰 (작은 화면에서만 표시) -->
          <div class="mobile-card-view d-md-none">
            <div id="driver_cards_enderose_list_01_container">
              <!-- 모바일 카드가 여기에 동적으로 추가됨 -->
            </div>
          </div>
          <!-- 모바일에서만 보이는 구분선 추가 -->
          <div class="mobile-space-divider d-md-none my-4"></div>


          <div class="col-lg-6 mb-4 d-none d-md-block">
            <div class="dashboard-card">
              <h5 class="mb-3 d-flex justify-content-between align-items-center">
                진행 완료 배서
                <span class="badge bg-success" id="completed-count">0건</span>
              </h5>
              <div class="table-responsive table-fixed-header">
                <table class="table table-hover table-mobile-stack">
                  <thead>
                    <tr>
                      <th>번호</th>
                      <th>성명</th>
                      <th>주민번호</th>
                      <th>핸드폰</th>
                      <th>증권번호</th>
                      <th>상태</th>
                    </tr>
                  </thead>
                  <tbody id='enderose_list_02'>
                    <!-- home_data_endorse_after.php return data 동적으로 표시 -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- 완료된 배서 모바일 카드 뷰 (필요한 경우 추가) -->
          <div class="mobile-card-view d-md-none">
            <div id="driver_cards_enderose_list_02_container">
              <!-- 모바일 카드가 여기에 동적으로 추가됨 -->
            </div>
          </div>
        </div>
      </div>

      <!-- 대리운전 - 기사찾기 탭 -->
      <div class="tab-pane fade" id="driver-search">
        
        <div class="dashboard-card mb-4">
          <form class="row g-3" id="driver-search-form">
            <div class="col-12 d-flex flex-wrap align-items-center gap-2">
              <div class="input-group" style="max-width: 400px;">
                <input type="text" class="form-control" id="driver-search-name" placeholder="기사 이름을 입력하세요" onkeypress="if(event.key === 'Enter') { driverSearch() ; return false; }" autocomplete="off" >
                <button class="btn btn-primary d-flex align-items-center" id="driver-search-btn">
				  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search me-1" viewBox="0 0 16 16">
					<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
				  </svg>
				  검색
				</button>
              </div>
              <div id="driver-search-count" class="ms-auto text-muted" style="display: none;">
                총 <span id="driver-total-count">0</span>명의 기사가 검색되었습니다.
              </div>
            </div>
          </form>
        </div>
        
        <div class="dashboard-card">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>순번</th>
                  <th>성명</th>
                  <th>주민번호</th>
                  <th>상태</th>
                  <th>증권의종류</th>
                  <th>보험사</th>
                  <th>증권번호</th>
                  <th>할인할증</th>
                  <th>핸드폰번호</th>
                </tr>
              </thead>
              <tbody id='driver_list_01'>
                <!-- driver_data.php return data 동적으로 표시 -->
              </tbody>
            </table>
          </div>
          <!-- 페이지네이션 컨테이너 -->
          <div id="pagination-container" class="mt-3 d-flex justify-content-center">
            <ul id="pagination" class="pagination"></ul>
          </div>
        </div>
        
        <!-- 모바일 카드 뷰 (작은 화면에서만 표시) -->
        <div class="mobile-card-view d-md-none">
          <div id="driver_cards_container">
            <!-- 모바일 카드가 여기에 동적으로 추가됨 -->
          </div>
          <!-- 모바일용 페이지네이션 -->
          <div id="mobile-pagination-container" class="mt-3 d-flex justify-content-center">
            <ul id="mobile-pagination" class="pagination pagination-sm"></ul>
          </div>
        </div>
      </div>
      
      <!-- 문자리스트 탭 -->
      <div class="tab-pane fade" id="sms-list">
       <div class="dashboard-card mb-4">
          <form class="row g-3" id="driver-search-form">
            <div class="col-12 d-flex flex-wrap align-items-center gap-2">
              <div class="input-group" style="max-width: 400px;">
                <input type="text" class="form-control" id="driver-search-name" placeholder="기사 이름을 입력하세요" onkeypress="if(event.key === 'Enter') { driverSearch() ; return false; }" autocomplete="off" >
                <button class="btn btn-primary d-flex align-items-center" id="driver-search-btn">
				  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search me-1" viewBox="0 0 16 16">
					<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
				  </svg>
				  검색
				</button>
              </div>
              <div id="driver-search-count" class="ms-auto text-muted" style="display: none;">
                총 <span id="driver-total-count">0</span>명의 기사가 검색되었습니다.
              </div>
            </div>
          </form>
        </div>
        
        <div class="dashboard-card">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>순번</th>
                  <th>성명</th>
                  <th>주민번호</th>
                  <th>상태</th>
                  <th>증권의종류</th>
                  <th>보험사</th>
                  <th>증권번호</th>
                  <th>할인할증</th>
                  <th>핸드폰번호</th>
                </tr>
              </thead>
              <tbody id='driver_list_01'>
                <!-- driver_data.php return data 동적으로 표시 -->
              </tbody>
            </table>
          </div>
          <!-- 페이지네이션 컨테이너 -->
          <div id="pagination-container" class="mt-3 d-flex justify-content-center">
            <ul id="pagination" class="pagination"></ul>
          </div>
        </div>
        
        <!-- 모바일 카드 뷰 (작은 화면에서만 표시) -->
        <div class="mobile-card-view d-md-none">
          <div id="driver_cards_container">
            <!-- 모바일 카드가 여기에 동적으로 추가됨 -->
          </div>
          <!-- 모바일용 페이지네이션 -->
          <div id="mobile-pagination-container" class="mt-3 d-flex justify-content-center">
            <ul id="mobile-pagination" class="pagination pagination-sm"></ul>
          </div>
        </div>
    </div>
  </div>

  <!-- 모달 창 -->
  <div id="subscription-modal" class="subscriptionModal">
    <div class="subscriptionModal-content">
      <button class="close-subscriptionModal" aria-label="닫기">X</button>
      <div id="subscriptionModal-body">
        <div class="modal-header">
          <span id="subscription_daeriCompany"></span>
        </div>
        <div id='m_subscription'></div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 탭 초기화 스크립트 -->
  <script src="js/tab-init.js"></script>
  <!-- 반응형 테이블 초기화 스크립트 추가 -->
  <script src="js/responsive-tables.js"></script>
  <!-- 커스텀 스크립트 -->
  <script src="./js/modal.js"></script>
  <script src="js/loading.js"></script>
  <script src="js/basic.js"></script>
  <script src="js/home.js"></script>
  <script src="js/driverSearch.js"></script>
  <script src="js/sms.js"></script>
  
  <!-- 배서기준일 표시를 위한 스크립트 -->
  <script>
    // 페이지 로드 시 배서기준일 표시
    document.addEventListener('DOMContentLoaded', function() {
      // calculateEndorsementDate 함수 호출 (home.js에 정의됨)
      const endorsementDate = calculateEndorsementDate();
      
      // 상단 배서기준일 표시 업데이트
      const dateElement = document.getElementById('endorsementDate');
      if (dateElement) {
        dateElement.textContent = endorsementDate;
      }
    });




  </script>
</body>
</html>